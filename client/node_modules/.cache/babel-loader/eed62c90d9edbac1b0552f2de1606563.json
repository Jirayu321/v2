{"ast":null,"code":"import _objectSpread from \"/Users/jirayuyungmeesuk/Desktop/code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/jirayuyungmeesuk/Desktop/code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nvar refProps = ['type', 'source', 'source-layer', 'minzoom', 'maxzoom', 'filter', 'layout']; // Prepare a map style object for diffing\n// If immutable - convert to plain object\n// Work around some issues in older styles that would fail Mapbox's diffing\n\nexport function normalizeStyle(style) {\n  if (!style) {\n    return null;\n  }\n\n  if (typeof style === 'string') {\n    return style;\n  }\n\n  if ('toJS' in style) {\n    style = style.toJS();\n  }\n\n  if (!style.layers) {\n    return style;\n  }\n\n  var layerIndex = {};\n\n  var _iterator = _createForOfIteratorHelper(style.layers),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var layer = _step.value;\n      layerIndex[layer.id] = layer;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  var layers = style.layers.map(function (layer) {\n    // @ts-expect-error\n    var layerRef = layerIndex[layer.ref];\n    var normalizedLayer = null;\n\n    if ('interactive' in layer) {\n      normalizedLayer = _objectSpread({}, layer); // Breaks style diffing :(\n\n      delete normalizedLayer.interactive;\n    } // Style diffing doesn't work with refs so expand them out manually before diffing.\n\n\n    if (layerRef) {\n      normalizedLayer = normalizedLayer || _objectSpread({}, layer);\n      delete normalizedLayer.ref; // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/deref.js\n\n      var _iterator2 = _createForOfIteratorHelper(refProps),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var propName = _step2.value;\n\n          if (propName in layerRef) {\n            normalizedLayer[propName] = layerRef[propName];\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n\n    return normalizedLayer || layer;\n  }); // Do not mutate the style object provided by the user\n\n  return _objectSpread(_objectSpread({}, style), {}, {\n    layers: layers\n  });\n}","map":{"version":3,"sources":["../../../src/utils/style-utils.ts"],"names":[],"mappings":";;AAEA,IAAM,QAAQ,GAAG,CAAC,MAAD,EAAS,QAAT,EAAmB,cAAnB,EAAmC,SAAnC,EAA8C,SAA9C,EAAyD,QAAzD,EAAmE,QAAnE,CAAjB,C,CAEA;AACA;AACA;;AACA,OAAM,SAAU,cAAV,CAAyB,KAAzB,EAAoE;EACxE,IAAI,CAAC,KAAL,EAAY;IACV,OAAO,IAAP;EACD;;EACD,IAAI,OAAO,KAAP,KAAiB,QAArB,EAA+B;IAC7B,OAAO,KAAP;EACD;;EACD,IAAI,UAAU,KAAd,EAAqB;IACnB,KAAK,GAAG,KAAK,CAAC,IAAN,EAAR;EACD;;EACD,IAAI,CAAC,KAAK,CAAC,MAAX,EAAmB;IACjB,OAAO,KAAP;EACD;;EACD,IAAM,UAAU,GAAG,EAAnB;;EAbwE,2CAepD,KAAK,CAAC,MAf8C;EAAA;;EAAA;IAexE,oDAAkC;MAAA,IAAvB,KAAuB;MAChC,UAAU,CAAC,KAAK,CAAC,EAAP,CAAV,GAAuB,KAAvB;IACD;EAjBuE;IAAA;EAAA;IAAA;EAAA;;EAmBxE,IAAM,MAAM,GAAG,KAAK,CAAC,MAAN,CAAa,GAAb,CAAiB,UAAA,KAAK,EAAG;IACtC;IACA,IAAM,QAAQ,GAAG,UAAU,CAAC,KAAK,CAAC,GAAP,CAA3B;IACA,IAAI,eAAe,GAAG,IAAtB;;IAEA,IAAI,iBAAiB,KAArB,EAA4B;MAC1B,eAAe,qBAAO,KAAP,CAAf,CAD0B,CAE1B;;MACA,OAAO,eAAe,CAAC,WAAvB;IACD,CATqC,CAWtC;;;IACA,IAAI,QAAJ,EAAc;MACZ,eAAe,GAAG,eAAe,sBAAQ,KAAR,CAAjC;MACA,OAAO,eAAe,CAAC,GAAvB,CAFY,CAGZ;;MAHY,4CAIW,QAJX;MAAA;;MAAA;QAIZ,uDAAiC;UAAA,IAAtB,QAAsB;;UAC/B,IAAI,QAAQ,IAAI,QAAhB,EAA0B;YACxB,eAAe,CAAC,QAAD,CAAf,GAA4B,QAAQ,CAAC,QAAD,CAApC;UACD;QACF;MARW;QAAA;MAAA;QAAA;MAAA;IASb;;IAED,OAAO,eAAe,IAAI,KAA1B;EACD,CAxBc,CAAf,CAnBwE,CA6CxE;;EACA,uCAAW,KAAX;IAAkB,MAAM,EAAN;EAAlB;AACD","sourceRoot":"","sourcesContent":["const refProps = ['type', 'source', 'source-layer', 'minzoom', 'maxzoom', 'filter', 'layout'];\n// Prepare a map style object for diffing\n// If immutable - convert to plain object\n// Work around some issues in older styles that would fail Mapbox's diffing\nexport function normalizeStyle(style) {\n    if (!style) {\n        return null;\n    }\n    if (typeof style === 'string') {\n        return style;\n    }\n    if ('toJS' in style) {\n        style = style.toJS();\n    }\n    if (!style.layers) {\n        return style;\n    }\n    const layerIndex = {};\n    for (const layer of style.layers) {\n        layerIndex[layer.id] = layer;\n    }\n    const layers = style.layers.map(layer => {\n        // @ts-expect-error\n        const layerRef = layerIndex[layer.ref];\n        let normalizedLayer = null;\n        if ('interactive' in layer) {\n            normalizedLayer = { ...layer };\n            // Breaks style diffing :(\n            delete normalizedLayer.interactive;\n        }\n        // Style diffing doesn't work with refs so expand them out manually before diffing.\n        if (layerRef) {\n            normalizedLayer = normalizedLayer || { ...layer };\n            delete normalizedLayer.ref;\n            // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/deref.js\n            for (const propName of refProps) {\n                if (propName in layerRef) {\n                    normalizedLayer[propName] = layerRef[propName];\n                }\n            }\n        }\n        return normalizedLayer || layer;\n    });\n    // Do not mutate the style object provided by the user\n    return { ...style, layers };\n}\n//# sourceMappingURL=style-utils.js.map"]},"metadata":{},"sourceType":"module"}