{"ast":null,"code":"'use strict';\n\nimport dialog from '../modules/dialog';\nvar KATEX_WEBSITE = \"https://katex.org/docs/supported.html\";\nexport default {\n  name: 'math',\n  display: 'dialog',\n  add: function add(core) {\n    core.addModule([dialog]);\n    var context = core.context;\n    context.math = {\n      focusElement: null,\n      // @Override dialog // This element has focus when the dialog is opened.\n      previewElement: null,\n      fontSizeElement: null,\n      defaultFontSize: '',\n      _mathExp: null\n    };\n    /** math dialog */\n\n    var math_dialog = this.setDialog(core);\n    context.math.modal = math_dialog;\n    context.math.focusElement = math_dialog.querySelector('.se-math-exp');\n    context.math.previewElement = math_dialog.querySelector('.se-math-preview');\n    context.math.fontSizeElement = math_dialog.querySelector('.se-math-size');\n    context.math.focusElement.addEventListener(core.util.isIE ? 'textinput' : 'input', this._renderMathExp.bind(core, context.math), false);\n    context.math.fontSizeElement.addEventListener('change', function (e) {\n      this.fontSize = e.target.value;\n    }.bind(context.math.previewElement.style), false);\n    /** math controller */\n\n    var math_controller = this.setController_MathButton(core);\n    context.math.mathController = math_controller;\n    context.math._mathExp = null;\n    /** add event listeners */\n\n    math_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core), false);\n    math_controller.addEventListener('click', this.onClick_mathController.bind(core));\n    context.math.previewElement.style.fontSize = context.math.defaultFontSize;\n    /** append html */\n\n    context.dialog.modal.appendChild(math_dialog);\n    context.element.relative.appendChild(math_controller);\n    /** empty memory */\n\n    math_dialog = null, math_controller = null;\n  },\n\n  /** dialog */\n  setDialog: function setDialog(core) {\n    var lang = core.lang;\n    var dialog = core.util.createElement('DIV');\n    var fontSize = core.options.mathFontSize;\n    var defaultFontSize = fontSize[0].value;\n    dialog.className = 'se-dialog-content';\n    dialog.style.display = 'none';\n    var html = '' + '<form>' + '<div class=\"se-dialog-header\">' + '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' + core.icons.cancel + '</button>' + '<span class=\"se-modal-title\">' + lang.dialogBox.mathBox.title + '</span>' + '</div>' + '<div class=\"se-dialog-body\">' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.mathBox.inputLabel + ' (<a href=\"' + KATEX_WEBSITE + '\" target=\"_blank\">KaTeX</a>)</label>' + '<textarea class=\"se-input-form se-math-exp\" type=\"text\"></textarea>' + '</div>' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.mathBox.fontSizeLabel + '</label>' + '<select class=\"se-input-select se-math-size\">';\n\n    for (var i = 0, len = fontSize.length, f; i < len; i++) {\n      f = fontSize[i];\n      if (f.default) defaultFontSize = f.value;\n      html += '<option value=\"' + f.value + '\"' + (f.default ? ' selected' : '') + '>' + f.text + '</option>';\n    }\n\n    html += '</select>' + '</div>' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.mathBox.previewLabel + '</label>' + '<p class=\"se-math-preview\"></p>' + '</div>' + '</div>' + '<div class=\"se-dialog-footer\">' + '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' + '</div>' + '</form>';\n    core.context.math.defaultFontSize = defaultFontSize;\n    dialog.innerHTML = html;\n    return dialog;\n  },\n\n  /** modify controller button */\n  setController_MathButton: function setController_MathButton(core) {\n    var lang = core.lang;\n    var math_btn = core.util.createElement('DIV');\n    math_btn.className = 'se-controller se-controller-link';\n    math_btn.innerHTML = '' + '<div class=\"se-arrow se-arrow-up\"></div>' + '<div class=\"link-content\">' + '<div class=\"se-btn-group\">' + '<button type=\"button\" data-command=\"update\" tabindex=\"-1\" class=\"se-btn se-tooltip\">' + core.icons.edit + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"delete\" tabindex=\"-1\" class=\"se-btn se-tooltip\">' + core.icons.delete + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' + '</button>' + '</div>' + '</div>' + '';\n    return math_btn;\n  },\n\n  /**\n   * @Required @Override dialog\n   */\n  open: function open() {\n    this.plugins.dialog.open.call(this, 'math', 'math' === this.currentControllerName);\n  },\n\n  /**\n   * @Override core - managedTagsInfo\n   */\n  managedTags: function managedTags() {\n    return {\n      className: 'katex',\n      method: function method(element) {\n        if (!element.getAttribute('data-exp') || !this.options.katex) return;\n\n        var dom = this._d.createRange().createContextualFragment(this.plugins.math._renderer.call(this, this.util.HTMLDecoder(element.getAttribute('data-exp'))));\n\n        element.innerHTML = dom.querySelector('.katex').innerHTML;\n      }\n    };\n  },\n  _renderer: function _renderer(exp) {\n    var result = '';\n\n    try {\n      this.util.removeClass(this.context.math.focusElement, 'se-error');\n      result = this.options.katex.src.renderToString(exp, {\n        throwOnError: true,\n        displayMode: true\n      });\n    } catch (error) {\n      this.util.addClass(this.context.math.focusElement, 'se-error');\n      result = '<span class=\"se-math-katex-error\">Katex syntax error. (Refer <a href=\"' + KATEX_WEBSITE + '\" target=\"_blank\">KaTeX</a>)</span>';\n      console.warn('[SUNEDITOR.math.Katex.error] ', error);\n    }\n\n    return result;\n  },\n  _renderMathExp: function _renderMathExp(contextMath, e) {\n    contextMath.previewElement.innerHTML = this.plugins.math._renderer.call(this, e.target.value);\n  },\n  submit: function submit(e) {\n    this.showLoading();\n    e.preventDefault();\n    e.stopPropagation();\n\n    var submitAction = function () {\n      if (this.context.math.focusElement.value.trim().length === 0) return false;\n      var contextMath = this.context.math;\n      var mathExp = contextMath.focusElement.value;\n      var katexEl = contextMath.previewElement.querySelector('.katex');\n      if (!katexEl) return false;\n      katexEl.className = '__se__katex ' + katexEl.className;\n      katexEl.setAttribute('contenteditable', false);\n      katexEl.setAttribute('data-exp', this.util.HTMLEncoder(mathExp));\n      katexEl.setAttribute('data-font-size', contextMath.fontSizeElement.value);\n      katexEl.style.fontSize = contextMath.fontSizeElement.value;\n\n      if (!this.context.dialog.updateModal) {\n        var selectedFormats = this.getSelectedElements();\n\n        if (selectedFormats.length > 1) {\n          var oFormat = this.util.createElement(selectedFormats[0].nodeName);\n          oFormat.appendChild(katexEl);\n          if (!this.insertNode(oFormat, null, true)) return false;\n        } else {\n          if (!this.insertNode(katexEl, null, true)) return false;\n        }\n\n        var empty = this.util.createTextNode(this.util.zeroWidthSpace);\n        katexEl.parentNode.insertBefore(empty, katexEl.nextSibling);\n        this.setRange(katexEl, 0, katexEl, 1);\n      } else {\n        var containerEl = this.util.getParentElement(contextMath._mathExp, '.katex');\n        containerEl.parentNode.replaceChild(katexEl, containerEl);\n        this.setRange(katexEl, 0, katexEl, 1);\n      }\n\n      contextMath.focusElement.value = '';\n      contextMath.fontSizeElement.value = '1em';\n      contextMath.previewElement.style.fontSize = '1em';\n      contextMath.previewElement.innerHTML = '';\n      return true;\n    }.bind(this);\n\n    try {\n      if (submitAction()) {\n        this.plugins.dialog.close.call(this); // history stack\n\n        this.history.push(false);\n      }\n    } catch (e) {\n      this.plugins.dialog.close.call(this);\n    } finally {\n      this.closeLoading();\n    }\n\n    return false;\n  },\n  active: function active(element) {\n    if (!element) {\n      if (this.controllerArray.indexOf(this.context.math.mathController) > -1) {\n        this.controllersOff();\n      }\n    } else if (element.getAttribute('data-exp')) {\n      if (this.controllerArray.indexOf(this.context.math.mathController) < 0) {\n        this.setRange(element, 0, element, 1);\n        this.plugins.math.call_controller.call(this, element);\n      }\n\n      return true;\n    }\n\n    return false;\n  },\n  on: function on(update) {\n    if (!update) {\n      this.plugins.math.init.call(this);\n    } else {\n      var contextMath = this.context.math;\n\n      if (contextMath._mathExp) {\n        var exp = this.util.HTMLDecoder(contextMath._mathExp.getAttribute('data-exp'));\n        var fontSize = contextMath._mathExp.getAttribute('data-font-size') || '1em';\n        this.context.dialog.updateModal = true;\n        contextMath.focusElement.value = exp;\n        contextMath.fontSizeElement.value = fontSize;\n        contextMath.previewElement.innerHTML = this.plugins.math._renderer.call(this, exp);\n        contextMath.previewElement.style.fontSize = fontSize;\n      }\n    }\n  },\n  call_controller: function call_controller(mathTag) {\n    this.context.math._mathExp = mathTag;\n    var mathBtn = this.context.math.mathController;\n    this.setControllerPosition(mathBtn, mathTag, 'bottom', {\n      left: 0,\n      top: 0\n    });\n    this.controllersOn(mathBtn, mathTag, 'math');\n  },\n  onClick_mathController: function onClick_mathController(e) {\n    e.stopPropagation();\n    var command = e.target.getAttribute('data-command') || e.target.parentNode.getAttribute('data-command');\n    if (!command) return;\n    e.preventDefault();\n\n    if (/update/.test(command)) {\n      this.context.math.focusElement.value = this.util.HTMLDecoder(this.context.math._mathExp.getAttribute('data-exp'));\n      this.plugins.dialog.open.call(this, 'math', true);\n    } else {\n      /** delete */\n      this.util.removeItem(this.context.math._mathExp);\n      this.context.math._mathExp = null;\n      this.focus(); // history stack\n\n      this.history.push(false);\n    }\n\n    this.controllersOff();\n  },\n  init: function init() {\n    var contextMath = this.context.math;\n    contextMath.mathController.style.display = 'none';\n    contextMath._mathExp = null;\n    contextMath.focusElement.value = '';\n    contextMath.previewElement.innerHTML = '';\n  }\n};","map":{"version":3,"names":["dialog","KATEX_WEBSITE","name","display","add","core","addModule","context","math","focusElement","previewElement","fontSizeElement","defaultFontSize","_mathExp","math_dialog","setDialog","modal","querySelector","addEventListener","util","isIE","_renderMathExp","bind","e","fontSize","target","value","style","math_controller","setController_MathButton","mathController","submit","onClick_mathController","appendChild","element","relative","lang","createElement","options","mathFontSize","className","html","dialogBox","close","icons","cancel","mathBox","title","inputLabel","fontSizeLabel","i","len","length","f","default","text","previewLabel","submitButton","innerHTML","math_btn","edit","controller","delete","remove","open","plugins","call","currentControllerName","managedTags","method","getAttribute","katex","dom","_d","createRange","createContextualFragment","_renderer","HTMLDecoder","exp","result","removeClass","src","renderToString","throwOnError","displayMode","error","addClass","console","warn","contextMath","showLoading","preventDefault","stopPropagation","submitAction","trim","mathExp","katexEl","setAttribute","HTMLEncoder","updateModal","selectedFormats","getSelectedElements","oFormat","nodeName","insertNode","empty","createTextNode","zeroWidthSpace","parentNode","insertBefore","nextSibling","setRange","containerEl","getParentElement","replaceChild","history","push","closeLoading","active","controllerArray","indexOf","controllersOff","call_controller","on","update","init","mathTag","mathBtn","setControllerPosition","left","top","controllersOn","command","test","removeItem","focus"],"sources":["/Users/jirayuyungmeesuk/Desktop/code/client/node_modules/suneditor/src/plugins/dialog/math.js"],"sourcesContent":["'use strict';\n\nimport dialog from '../modules/dialog';\n\nconst KATEX_WEBSITE = \"https://katex.org/docs/supported.html\";\n\nexport default {\n    name: 'math',\n    display: 'dialog',\n    add: function (core) {\n        core.addModule([dialog]);\n\n        const context = core.context;\n        context.math = {\n            focusElement: null, // @Override dialog // This element has focus when the dialog is opened.\n            previewElement: null,\n            fontSizeElement: null,\n            defaultFontSize: '',\n            _mathExp: null\n        };\n\n        /** math dialog */\n        let math_dialog = this.setDialog(core);\n        context.math.modal = math_dialog;\n        context.math.focusElement = math_dialog.querySelector('.se-math-exp');\n        context.math.previewElement = math_dialog.querySelector('.se-math-preview');\n        context.math.fontSizeElement = math_dialog.querySelector('.se-math-size');\n        context.math.focusElement.addEventListener(core.util.isIE ? 'textinput' : 'input', this._renderMathExp.bind(core, context.math), false);\n        context.math.fontSizeElement.addEventListener('change', function (e) { this.fontSize = e.target.value; }.bind(context.math.previewElement.style), false);\n\n        /** math controller */\n        let math_controller = this.setController_MathButton(core);\n        context.math.mathController = math_controller;\n        context.math._mathExp = null;\n\n        /** add event listeners */\n        math_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core), false);\n        math_controller.addEventListener('click', this.onClick_mathController.bind(core));\n        context.math.previewElement.style.fontSize = context.math.defaultFontSize;\n\n        /** append html */\n        context.dialog.modal.appendChild(math_dialog);\n        context.element.relative.appendChild(math_controller);\n\n        /** empty memory */\n        math_dialog = null, math_controller = null;\n    },\n\n    /** dialog */\n    setDialog: function (core) {\n        const lang = core.lang;\n        const dialog = core.util.createElement('DIV');\n        const fontSize = core.options.mathFontSize;\n        let defaultFontSize = fontSize[0].value;\n\n        dialog.className = 'se-dialog-content';\n        dialog.style.display = 'none';\n        let html = '' +\n        '<form>' +\n            '<div class=\"se-dialog-header\">' +\n                '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' +\n                    core.icons.cancel +\n                '</button>' +\n                '<span class=\"se-modal-title\">' + lang.dialogBox.mathBox.title + '</span>' +\n            '</div>' +\n            '<div class=\"se-dialog-body\">' +\n                '<div class=\"se-dialog-form\">' +\n                    '<label>' + lang.dialogBox.mathBox.inputLabel + ' (<a href=\"' + KATEX_WEBSITE + '\" target=\"_blank\">KaTeX</a>)</label>' +\n                    '<textarea class=\"se-input-form se-math-exp\" type=\"text\"></textarea>' +\n                '</div>' +\n                '<div class=\"se-dialog-form\">' +\n                    '<label>' + lang.dialogBox.mathBox.fontSizeLabel + '</label>' +\n                    '<select class=\"se-input-select se-math-size\">';\n                    for (let i = 0, len = fontSize.length, f; i < len; i++) {\n                        f = fontSize[i];\n                        if (f.default) defaultFontSize = f.value;\n                        html += '<option value=\"' + f.value + '\"' + (f.default ? ' selected' : '') + '>' + f.text + '</option>';\n                    }\n                html += '</select>' +\n                '</div>' +\n                '<div class=\"se-dialog-form\">' +\n                    '<label>' + lang.dialogBox.mathBox.previewLabel + '</label>' +\n                    '<p class=\"se-math-preview\"></p>' +\n                '</div>' +\n            '</div>' +\n            '<div class=\"se-dialog-footer\">' +\n                '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' +\n            '</div>' +\n        '</form>';\n\n        core.context.math.defaultFontSize = defaultFontSize;\n        dialog.innerHTML = html;\n        return dialog;\n    },\n\n    /** modify controller button */\n    setController_MathButton: function (core) {\n        const lang = core.lang;\n        const math_btn = core.util.createElement('DIV');\n\n        math_btn.className = 'se-controller se-controller-link';\n        math_btn.innerHTML = '' +\n        '<div class=\"se-arrow se-arrow-up\"></div>' +\n        '<div class=\"link-content\">' +\n            '<div class=\"se-btn-group\">' +\n                '<button type=\"button\" data-command=\"update\" tabindex=\"-1\" class=\"se-btn se-tooltip\">' +\n                    core.icons.edit +\n                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' +\n                '</button>' +\n                '<button type=\"button\" data-command=\"delete\" tabindex=\"-1\" class=\"se-btn se-tooltip\">' +\n                    core.icons.delete +\n                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' +\n                '</button>' +\n            '</div>' +\n        '</div>' +\n        '';\n\n        return math_btn;\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    open: function () {\n        this.plugins.dialog.open.call(this, 'math', 'math' === this.currentControllerName);\n    },\n\n    /**\n     * @Override core - managedTagsInfo\n     */\n    managedTags: function () {\n        return {\n            className: 'katex',\n            method: function (element) {\n                if (!element.getAttribute('data-exp') || !this.options.katex) return;\n                const dom = this._d.createRange().createContextualFragment(this.plugins.math._renderer.call(this, this.util.HTMLDecoder(element.getAttribute('data-exp'))));\n                element.innerHTML = dom.querySelector('.katex').innerHTML;\n            }\n        };\n    },\n\n    _renderer: function (exp) {\n        let result = '';\n        try {\n            this.util.removeClass(this.context.math.focusElement, 'se-error');\n            result = this.options.katex.src.renderToString(exp, {throwOnError: true, displayMode: true});\n        } catch(error) {\n            this.util.addClass(this.context.math.focusElement, 'se-error');\n            result = '<span class=\"se-math-katex-error\">Katex syntax error. (Refer <a href=\"' + KATEX_WEBSITE + '\" target=\"_blank\">KaTeX</a>)</span>';\n            console.warn('[SUNEDITOR.math.Katex.error] ', error);\n        }\n        return result;\n    },\n\n    _renderMathExp: function (contextMath, e) {\n        contextMath.previewElement.innerHTML = this.plugins.math._renderer.call(this, e.target.value);\n    },\n\n    submit: function (e) {\n        this.showLoading();\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        const submitAction = function () {\n            if (this.context.math.focusElement.value.trim().length === 0) return false;\n\n            const contextMath = this.context.math;\n            const mathExp = contextMath.focusElement.value;\n            const katexEl = contextMath.previewElement.querySelector('.katex');\n\n            if (!katexEl) return false;\n            katexEl.className = '__se__katex ' + katexEl.className;\n            katexEl.setAttribute('contenteditable', false);\n            katexEl.setAttribute('data-exp', this.util.HTMLEncoder(mathExp));\n            katexEl.setAttribute('data-font-size', contextMath.fontSizeElement.value);\n            katexEl.style.fontSize = contextMath.fontSizeElement.value;\n\n            if (!this.context.dialog.updateModal) {\n                const selectedFormats = this.getSelectedElements();\n\n                if (selectedFormats.length > 1) {\n                    const oFormat = this.util.createElement(selectedFormats[0].nodeName);\n                    oFormat.appendChild(katexEl);\n                    if (!this.insertNode(oFormat, null, true)) return false;\n                } else {\n                    if (!this.insertNode(katexEl, null, true)) return false;\n                }\n\n                const empty = this.util.createTextNode(this.util.zeroWidthSpace);\n                katexEl.parentNode.insertBefore(empty, katexEl.nextSibling);\n                this.setRange(katexEl, 0, katexEl, 1);\n            } else {\n                const containerEl = this.util.getParentElement(contextMath._mathExp, '.katex');\n                containerEl.parentNode.replaceChild(katexEl, containerEl);\n                this.setRange(katexEl, 0, katexEl, 1);\n            }\n\n            contextMath.focusElement.value = '';\n            contextMath.fontSizeElement.value = '1em';\n            contextMath.previewElement.style.fontSize = '1em';\n            contextMath.previewElement.innerHTML = '';\n\n            return true;\n        }.bind(this);\n\n        try {\n            if (submitAction()) {\n                this.plugins.dialog.close.call(this);\n                // history stack\n                this.history.push(false);\n            }\n        } catch (e) {\n            this.plugins.dialog.close.call(this);\n        } finally {\n            this.closeLoading();\n        }\n\n        return false;\n    },\n\n    active: function (element) {\n        if (!element) {\n            if (this.controllerArray.indexOf(this.context.math.mathController) > -1) {\n                this.controllersOff();\n            }\n        } else if (element.getAttribute('data-exp')) {\n            if (this.controllerArray.indexOf(this.context.math.mathController) < 0) {\n                this.setRange(element, 0, element, 1);\n                this.plugins.math.call_controller.call(this, element);\n            }\n            return true;\n        }\n\n        return false;\n    },\n\n    on: function (update) {\n        if (!update) {\n            this.plugins.math.init.call(this);\n        } else {\n            const contextMath = this.context.math;\n            if (contextMath._mathExp) {\n                const exp = this.util.HTMLDecoder(contextMath._mathExp.getAttribute('data-exp'));\n                const fontSize = contextMath._mathExp.getAttribute('data-font-size') || '1em';\n                this.context.dialog.updateModal = true;\n                contextMath.focusElement.value = exp;\n                contextMath.fontSizeElement.value = fontSize;\n                contextMath.previewElement.innerHTML = this.plugins.math._renderer.call(this, exp);\n                contextMath.previewElement.style.fontSize = fontSize;\n            }\n        }\n    },\n\n    call_controller: function (mathTag) {\n        this.context.math._mathExp = mathTag;\n        const mathBtn = this.context.math.mathController;\n\n        this.setControllerPosition(mathBtn, mathTag, 'bottom', {left: 0, top: 0});\n        this.controllersOn(mathBtn, mathTag, 'math');\n    },\n\n    onClick_mathController: function (e) {\n        e.stopPropagation();\n\n        const command = e.target.getAttribute('data-command') || e.target.parentNode.getAttribute('data-command');\n        if (!command) return;\n\n        e.preventDefault();\n\n        if (/update/.test(command)) {\n            this.context.math.focusElement.value = this.util.HTMLDecoder(this.context.math._mathExp.getAttribute('data-exp'));\n            this.plugins.dialog.open.call(this, 'math', true);\n        } else {\n            /** delete */\n            this.util.removeItem(this.context.math._mathExp);\n            this.context.math._mathExp = null;\n            this.focus();\n\n            // history stack\n            this.history.push(false);\n        }\n\n        this.controllersOff();\n    },\n\n    init: function () {\n        const contextMath = this.context.math;\n        contextMath.mathController.style.display = 'none';\n        contextMath._mathExp = null;\n        contextMath.focusElement.value = '';\n        contextMath.previewElement.innerHTML = '';\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}